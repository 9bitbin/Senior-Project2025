<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vidia - Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Welcome to Vidia</h1>
    <p id="user-info">Loading user info...</p>

    <!-- ðŸ”¹ User Health Info Section -->
    <div class="container">
        <h2>Your Health Information</h2>
        <p><strong>Weight:</strong> <span id="user-weight">Loading...</span> lbs</p>
        <p><strong>Height:</strong> <span id="user-height">Loading...</span> inches</p>
    </div>

    <!-- ðŸ”¹ BMI Section -->
    <div class="container">
        <h2>Your BMI</h2>
        <p id="bmi-value">BMI Value: Calculating...</p>
        <p id="bmi-category">Category: Calculating...</p>
    </div>

    <!-- ðŸ”¹ Food Logging & Meal History -->
    <div class="container">
        <h2>Food Logging & Meal History</h2>
        <input type="text" id="food-input" placeholder="Enter food (e.g., 2 eggs, 1 toast)">
        <button id="fetch-nutrition">Get Nutrition Info</button>

        <div id="nutrition-results">
            <h3>Nutrition Breakdown</h3>
            <p><strong>Calories:</strong> <span id="calories">--</span> kcal</p>
            <p><strong>Protein:</strong> <span id="protein">--</span> g</p>
            <p><strong>Carbs:</strong> <span id="carbs">--</span> g</p>
            <p><strong>Fat:</strong> <span id="fat">--</span> g</p>
        </div>

        <label for="start-date">Start Date:</label>
        <input type="date" id="start-date">
        <label for="end-date">End Date:</label>
        <input type="date" id="end-date">
        <button id="filter-meals">Filter Meals</button>
        <button id="reset-meals">Reset</button>

        <h3>Meal History</h3>
        <p><strong>Average Daily Calories:</strong> <span id="average-calories">Calculating...</span> kcal</p>
        <p><strong>Total Calories:</strong> <span id="total-calories">0</span> kcal</p>
        <ul id="meal-list">
            <li>Loading...</li>
        </ul>
    </div>




   <!-- Meal Budget Tracking -->
<div class="container">
    <h2>Meal Budget Tracking</h2>
    <label>Set Budget ($):</label>
    <input type="number" id="budget-amount" placeholder="Enter budget">
    
    <label>Budget Period:</label>
    <select id="budget-period">
        <option value="Daily">Daily</option>
        <option value="Weekly">Weekly</option>
        <option value="Monthly">Monthly</option>
    </select>
    <button id="set-budget">Set Budget</button>

    <label>Log Meal Cost ($):</label>
    <input type="number" id="meal-cost" placeholder="Enter meal cost">
    <button id="log-meal-cost">Log Cost</button>

    <!-- Budget Overview -->
    <h3>Budget Overview</h3>
    <p><strong>Budget:</strong> $<span id="budget-value">0</span></p>
    <p><strong>Total Spent:</strong> $<span id="total-spent">0</span></p>
    <p><strong>Remaining Budget:</strong> $<span id="remaining-budget">0</span></p>
    <p id="budget-alert" style="color: red;"></p>
</div>

<!-- Meal Budget History -->
<div class="container">
    <h2>Spending History</h2>

    <!-- ðŸ”¹ Date Range Filtering -->
    <label for="budget-start-date">Start Date:</label>
    <input type="date" id="budget-start-date">
    
    <label for="budget-end-date">End Date:</label>
    <input type="date" id="budget-end-date">
    
    <button id="filter-budget">Filter Budget</button>
    <button id="reset-budget">Reset</button>

    <!-- ðŸ”¹ Spending History List -->
    <h3>Meal Expenses</h3>
    <ul id="budget-history-list">
        <li>Loading...</li>
    </ul>
</div>

<!-- ðŸ”¹ Budget Trend Chart Section -->
<div class="container">
    <h2>Meal Budget Trends</h2>
    <canvas id="budgetChart"></canvas>
</div>






    <!-- ðŸ”¹ Weekly & Monthly Calorie Trend -->
    <div class="container">
        <h2>Calorie Trends</h2>
        <canvas id="calorieChart"></canvas>
    </div>

    <!-- ðŸ”¹ Exercise Tracking Section -->
    <div class="container">
        <h2>Exercise Recommendations</h2>
        <label for="exercise-type">Select Workout Type:</label>
        <select id="exercise-type">
            <option value="cardio">Cardio</option>
            <option value="strength">Strength</option>
            <option value="stretching">Stretching</option>
            <option value="yoga">Yoga</option>
        </select>
        <button id="fetch-exercise">Get Exercises</button>

        <div id="exercise-results">
            <h3>Suggested Workouts</h3>
            <ul id="exercise-list">
                <li>Exercises will appear here...</li>
            </ul>
        </div>
    </div>

    <!-- ðŸ”¹ Workout Tracking Section -->
    <div class="container">
        <h2>Workout Tracking</h2>
        <label for="workout-type">Workout Type:</label>
        <select id="workout-type">
            <option value="cardio">Cardio</option>
            <option value="strength">Strength</option>
            <option value="stretching">Stretching</option>
            <option value="yoga">Yoga</option>
        </select>
        <label for="workout-duration">Duration (minutes):</label>
        <input type="number" id="workout-duration" min="1">
        <button id="get-calories">Get Estimated Calories</button>
        <p><strong>Estimated Calories Burned:</strong> <span id="estimated-calories">--</span> kcal</p>
        <button id="log-workout">Log Workout</button>
    </div>

    <!-- ðŸ”¹ Workout History Section -->
    <div class="container">
        <h2>Workout History</h2>
        <label for="workout-start-date">Start Date:</label>
        <input type="date" id="workout-start-date">
        <label for="workout-end-date">End Date:</label>
        <input type="date" id="workout-end-date">
        <button id="filter-workouts">Filter Workouts</button>
        <button id="reset-workouts">Reset</button>

        <h3>Workout Logs</h3>
        <p><strong>Total Calories Burned:</strong> <span id="total-workout-calories">0</span> kcal</p>
        <ul id="workout-list">
            <li>Loading...</li>
        </ul>
    </div>

    <!-- ðŸ”¹ Logout Button -->
    <button id="logoutBtn">Logout</button>

    <script type="module" src="firebase-config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="bmi.js"></script>
    <script type="module" src="nutrition.js"></script>
    <script type="module" src="exercise.js"></script>
    <script type="module" src="workout.js"></script>
    <script type="module" src="budget.js"></script>
    <script type="module" src="goal.js"></script>

    <script type="module">
        import { auth, db } from "./firebase-config.js";
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";
        import { doc, getDoc } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";

        const userInfo = document.getElementById("user-info");
        const logoutBtn = document.getElementById("logoutBtn");
        const weightEl = document.getElementById("user-weight");
        const heightEl = document.getElementById("user-height");

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userInfo.innerText = `Welcome, ${user.email}`;

                const userDocRef = doc(db, "users", user.uid);
                const userDoc = await getDoc(userDocRef);

                if (userDoc.exists()) {
                    const data = userDoc.data();
                    weightEl.innerText = data.weight || "N/A";
                    heightEl.innerText = data.height || "N/A";
                } else {
                    weightEl.innerText = "N/A";
                    heightEl.innerText = "N/A";
                }
            } else {
                window.location.href = "index.html";
            }
        });

        logoutBtn.addEventListener("click", () => {
            signOut(auth).then(() => {
                window.location.href = "index.html";
            }).catch((error) => {
                console.error("Logout Error: ", error);
            });
        });
    </script>
</body>
</html>


